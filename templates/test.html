<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/test.css">
    <title>Major Map</title>
</head>

<body>

<div>
    <header id="site_header">
        ASU Major Mapping
    </header>
</div>
<div id="top_menu">

    <script src="../static/svg_stuff.js"></script>
    <script>
        var svg_data = "";

        function waitForElementToDisplay(selector, callback, checkFrequencyInMs, timeoutInMs) {
          var startTimeInMs = Date.now();
          (function loopSearch() {
            if (document.getElementById(selector) != null) {
              callback();
              return;
            }
            else {
              setTimeout(function () {
                if (timeoutInMs && Date.now() - startTimeInMs > timeoutInMs)
                  return;
                loopSearch();
              }, checkFrequencyInMs);
            }
          })();
        }

        function major_name() {
            const formData = document.getElementById("major_name_box").value;
            const xhttp = new XMLHttpRequest();
            document.getElementById('svg_container').innerHTML = '';
            xhttp.onload = function () {
                if (this.responseText === "reset svg") {
                    resetSvgStuff();
                } else {
                    document.getElementById('svg_container').innerHTML = this.responseText;
                    if (this.responseText.substring(0, 4) === "<svg") {
                        svg_data = this.responseText;
                    }
                }
            };
            xhttp.open("POST", "/test");
            xhttp.setRequestHeader('data', formData);
            xhttp.send();
            waitForElementToDisplay("major_map_svg", function() {
                console.log(document.getElementById('major_map_svg'));
                foo();
            }, 200, 1000000);
        }

        function resetSvgStuff() {
            document.getElementById('svg_container').innerHTML = svg_data;
            foo();
        }

        function deleteCookies() {
            console.log('delete!');
        }
    </script>

    <div id="top_buttons">
        <form id='major_name_form' method="post">
            <label for="major_name_box"></label>
            <input type="text" id="major_name_box" name="major_name_box"
                   placeholder="Link to (or precise name of) major map" required>
            <input type="reset" id="major_name_box_submit" onclick="major_name();" value="Add">
        </form>
    </div>

    <button id="reset_button" type="button" onclick="resetSvgStuff()">Reset</button>
</div>

<div id="svg_container">
</div>


</body>
</html>